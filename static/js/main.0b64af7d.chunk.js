(this["webpackJsonpweb-proj"]=this["webpackJsonpweb-proj"]||[]).push([[0],{40:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(34),r=n.n(a),s=(n(40),n(2)),i=n(10),o=n(3),l=n(7),u=n.n(l),d=n(13),p=n(14),j=n.n(p),x={isAuthenticated:!1,signin:function(){var e=Object(d.a)(u.a.mark((function e(t,n,c){var a,r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.post("https://posts-pw2021.herokuapp.com/api/v1/auth/signin",t);case 3:a=e.sent,r=a.data,n(r),x.isAuthenticated=!0,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),s=e.t0.response,c(s);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n,c){return e.apply(this,arguments)}}(),signout:function(e){x.isAuthenticated=!1,e&&e()}},b=n(0),m=Object(c.createContext)(),h=function(e){var t=e.children,n=Object(c.useState)(null),a=Object(o.a)(n,2),r=a[0],s=a[1],i={user:r,signIn:function(e,t,n){return x.signin(e,(function(e){s(e),t()}),n)},signOut:function(e){return x.signout((function(){s(null),e()}))}};return Object(b.jsx)(m.Provider,{value:i,children:t})},f=n(12),O=function(e){var t=e.type,n=e.name,c=e.id,a=e.placeholder;return Object(b.jsxs)("div",{className:"w-full flex flex-col space-y-2",children:[Object(b.jsx)("label",{className:"font-medium",htmlFor:n,children:n}),Object(b.jsx)("input",{className:"px-3 py-1 rounded-full border-2 border-primary",type:t,id:c,name:c,placeholder:a})]})},v=function(e){var t=e.items,n=e.submitText,c=e.handleSubmit;return Object(b.jsxs)("form",{className:"w-full bg-white rounded-2xl p-4 space-y-8 flex flex-col items-end",onSubmit:c,children:[null===t||void 0===t?void 0:t.map((function(e){return Object(b.jsx)(O,{type:e.type,name:e.name,id:e.id,placeholder:e.placeholder},Object(f.generate)())})),Object(b.jsx)("button",{className:"text-white bg-primary font-bold rounded-full px-4 py-2",type:"submit",children:n})]})},g=function(){return Object(c.useContext)(m)},y=function(){var e,t,n=Object(s.h)(),c=Object(s.g)(),a=g(),r=(null===(e=c.state)||void 0===e||null===(t=e.from)||void 0===t?void 0:t.pathname)||"/";return Object(b.jsxs)("div",{className:"-mt-10 w-screen h-screen px-10 flex flex-col items-center justify-center space-y-10 max-w-screen-sm mx-auto",children:[Object(b.jsxs)("h1",{className:"font-bold text-lg",children:["\xa1Bienvenido!",Object(b.jsx)("br",{}),Object(b.jsx)("span",{className:"text-base",children:"Inicia sesi\xf3n para acceder a las p\xe1ginas"})]}),Object(b.jsx)(v,{items:[{type:"text",name:"Usuario",id:"username",placeholder:"Juan Perez"},{type:"password",name:"Contrase\xf1a",id:"password",placeholder:"******"}],submitText:"Iniciar sesi\xf3n",handleSubmit:function(e){e.preventDefault();var t=new FormData(e.target),c=Array.from(t.values());if(c.some((function(e){return""===e}))||c.length<=0)alert("Llena todos los campos primero");else{var s=Object.fromEntries(t.entries());a.signIn(s,(function(){n(r,{replace:!0})}),(function(){alert("error")}))}}})]})},w=n(16),k=n(11),N=n(5),C=n(6),S=function(e){var t=e.description,n=e.user;return Object(b.jsxs)("div",{className:"text-xs px-4 py-2 space-y-2 border-t border-gray-400 lg:text-sm",children:[Object(b.jsxs)("h1",{className:"font-bold",children:["@",n.username]}),Object(b.jsx)("h2",{children:t})]})},A=function(e){var t,n=e.postId,a=e.triggerUpdate,r=Object(c.useRef)(null),s=Object(c.useState)(),i=Object(o.a)(s,2),l=i[0],p=i[1],j=g(),x=Object(k.a)({url:"".concat("https://posts-pw2021.herokuapp.com/api/v1","/post/comment/").concat(n),method:"PATCH",headers:{Authorization:"Bearer ".concat(null===j||void 0===j||null===(t=j.user)||void 0===t?void 0:t.token)}},{manual:!0}),m=Object(o.a)(x,2)[1];function h(){return(h=Object(d.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==(null===r||void 0===r||null===(n=r.current)||void 0===n?void 0:n.value)){e.next=4;break}return alert("No puedes agregar un comentario vacio"),e.abrupt("return");case 4:return e.prev=4,e.next=7,m({data:{description:null===r||void 0===r||null===(c=r.current)||void 0===c?void 0:c.value}});case 7:return e.next=9,a();case 9:p(""),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0.response),alert("error");case 16:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}return Object(b.jsx)("form",{className:"w-full px-4 my-2",onSubmit:function(e){return h.apply(this,arguments)},children:Object(b.jsx)("input",{ref:r,className:"w-full rounded-lg px-2 py-1 border-2 border-primary text-sm",type:"text",value:l,placeholder:"Presiona enter para comentar...",onChange:function(e){return p(e.target.value)}})})},z=function(e){var t,n,a,r,i,l=e.post,p=g(),x=Object(c.useState)(),m=Object(o.a)(x,2),h=m[0],O=m[1],v=Object(s.g)(),y=Object(c.useState)(l),w=Object(o.a)(y,2),z=w[0],B=w[1],P=Object(c.useState)(!1),T=Object(o.a)(P,2),I=T[0],E=T[1],D=Object(c.useState)(z.active),M=Object(o.a)(D,2),F=M[0],U=M[1],_=Object(k.a)({url:"".concat("https://posts-pw2021.herokuapp.com/api/v1","/post/one/").concat(z._id),headers:{Authorization:"Bearer ".concat(null===p||void 0===p||null===(t=p.user)||void 0===t?void 0:t.token)}},{manual:!0}),H=Object(o.a)(_,2)[1],J=Object(k.a)({url:"".concat("https://posts-pw2021.herokuapp.com/api/v1","/post/like/").concat(z._id),method:"PATCH",headers:{Authorization:"Bearer ".concat(null===p||void 0===p||null===(n=p.user)||void 0===n?void 0:n.token)}},{manual:!0}),L=Object(o.a)(J,2)[1],R=Object(k.a)({url:"".concat("https://posts-pw2021.herokuapp.com/api/v1","/post/toggle/").concat(z._id),method:"PATCH",headers:{Authorization:"Bearer ".concat(null===p||void 0===p||null===(a=p.user)||void 0===a?void 0:a.token)}},{manual:!0}),V=Object(o.a)(R,2)[1];function q(e){return G.apply(this,arguments)}function G(){return(G=Object(d.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=4;break}return e.next=4,t();case 4:return e.next=6,H();case 6:n=e.sent,c=n.data,B(c),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),"/my"===v.pathname?alert("Post desactivado"):alert("error sad");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}return Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.get("".concat("https://posts-pw2021.herokuapp.com/api/v1","/auth/whoami"),{headers:{Authorization:"Bearer ".concat(null===p||void 0===p||null===(t=p.user)||void 0===t?void 0:t.token)}});case 3:n=e.sent,O(n.data.username),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(b.jsxs)("div",{className:"w-full rounded-lg bg-gray-300 flex flex-col mb-6 md:w-2/5 md:m-4 lg:w-1/4 relative",children:["/my"===v.pathname&&"admin"===(null===p||void 0===p||null===(r=p.user)||void 0===r?void 0:r.role)?Object(b.jsx)("div",{className:"absolute top-0 right-0 p-2 space-x-1 flex items-center cursor-pointer\n                    ".concat(F&&"text-red-800"),onClick:function(){q(V),U(!F)},children:Object(b.jsx)(N.a,{icon:C.d})}):Object(b.jsxs)("div",{className:"absolute top-0 right-0 p-2 space-x-1 flex items-center cursor-pointer\n                    ".concat(z.likes.some((function(e){return e.username===h}))&&"text-red-800"),onClick:function(){return q(L)},children:[Object(b.jsx)(N.a,{icon:C.e}),Object(b.jsx)("span",{className:"text-xs",children:null!==(i=z.likes.length)&&void 0!==i?i:0})]}),Object(b.jsxs)("div",{className:"bg-gray-400 rounded-t px-4 py-2 font-medium space-y-2",children:[Object(b.jsxs)("h1",{className:"text-xs text-gray-800 lg:text-sm",children:["@ ",z.user.username]}),Object(b.jsx)("h2",{className:"text-sm lg:text-base",children:z.title})]}),z.image&&Object(b.jsx)("div",{className:"w-full ",children:Object(b.jsx)("img",{className:"h-40 w-full object-contain",src:z.image,alt:z.title})}),Object(b.jsx)("div",{className:"px-4 py-2 text-sm lg:text-base",children:Object(b.jsx)("p",{children:z.description})}),Object(b.jsx)("div",{className:"w-full bg-gray-400 text-center py-2 cursor-pointer select-none",onClick:function(){return E(!I)},children:z.comments.length>0&&Object(b.jsxs)("span",{children:[Object(b.jsx)(N.a,{icon:C.c})," Mostrar comentarios"]})}),Object(b.jsxs)("div",{children:[I&&z.comments.map((function(e){return Object(b.jsx)(S,{description:e.description,user:e.user},Object(f.generate)())})),Object(b.jsx)(A,{postId:z._id,triggerUpdate:q})]})]})},B=function(){var e,t=g(),n=Object(c.useState)({limit:14,page:0}),a=Object(o.a)(n,2),r=a[0],s=a[1],i=Object(k.a)({url:"https://posts-pw2021.herokuapp.com/api/v1/post/all",params:r,headers:{Authorization:"Bearer ".concat(null===t||void 0===t||null===(e=t.user)||void 0===e?void 0:e.token)}},{manual:!0}),l=Object(o.a)(i,2),u=l[0].data,d=l[1];function p(e){r.page+e>u.pages||r.page+e<0||s(Object(w.a)(Object(w.a)({},r),{},{page:r.page+e}))}return Object(c.useEffect)((function(){d()}),[r,d]),Object(b.jsxs)("div",{className:"w-full flex flex-wrap items-center justify-center",children:[Object(b.jsx)("div",{className:"w-full bg-primary py-4",children:Object(b.jsxs)("div",{className:"w-1/3 flex justify-evenly mx-auto items-center",children:[Object(b.jsx)(N.a,{icon:C.a,onClick:function(){return p(-1)}}),"Mostrando pagina ",(null===u||void 0===u?void 0:u.page)+1,Object(b.jsx)(N.a,{icon:C.b,onClick:function(){return p(1)}})]})}),(null===u||void 0===u?void 0:u.data)&&(null===u||void 0===u?void 0:u.data.map((function(e){return Object(b.jsx)(z,{post:e},Object(f.generate)())})))]})},P=function(){var e,t=g(),n=Object(c.useState)({limit:14,page:0}),a=Object(o.a)(n,2),r=a[0],s=a[1],i=Object(k.a)({url:"https://posts-pw2021.herokuapp.com/api/v1/post/owned",params:r,headers:{Authorization:"Bearer ".concat(null===t||void 0===t||null===(e=t.user)||void 0===e?void 0:e.token)}},{manual:!0}),l=Object(o.a)(i,2),u=l[0].data,d=l[1];function p(e){r.page+e>u.pages||r.page+e<0||s(Object(w.a)(Object(w.a)({},r),{},{page:r.page+e}))}return Object(c.useEffect)((function(){d()}),[r,d]),!u||u.data.length<=0?Object(b.jsx)("div",{children:"Sin posts aun..."}):Object(b.jsxs)("div",{className:"w-full flex flex-wrap items-center justify-center",children:[Object(b.jsx)("div",{className:"w-full bg-primary py-4",children:Object(b.jsxs)("div",{className:"w-1/3 flex justify-evenly mx-auto items-center",children:[Object(b.jsx)(N.a,{icon:C.a,onClick:function(){return p(-1)}}),"Mostrando pagina ",(null===u||void 0===u?void 0:u.page)+1,Object(b.jsx)(N.a,{icon:C.b,onClick:function(){return p(1)}})]})}),(null===u||void 0===u?void 0:u.data)&&(null===u||void 0===u?void 0:u.data.map((function(e){return Object(b.jsx)(z,{post:e},Object(f.generate)())})))]})},T=function(){var e,t=g(),n=Object(k.a)({url:"".concat("https://posts-pw2021.herokuapp.com/api/v1","/post/create"),method:"POST",headers:{Authorization:"Bearer ".concat(null===t||void 0===t||null===(e=t.user)||void 0===e?void 0:e.token)}},{manual:!0}),c=Object(o.a)(n,2)[1];function a(){return(a=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,n=new FormData(t.target),!Array.from(n.values()).some((function(e){return""===e}))){e.next=7;break}return alert("Llena los campos necesarios"),e.abrupt("return");case 7:return a=Object.fromEntries(n.entries()),e.next=10,c({data:a});case 10:alert("Post creado"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),alert("error"),console.log(e.t0.response);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}return Object(b.jsx)("div",{className:"-mt-10 w-screen h-screen px-10 flex flex-col items-center justify-center space-y-10 max-w-screen-sm mx-auto",children:Object(b.jsx)(v,{items:[{type:"text",name:"Titulo",id:"title",placeholder:"Mi post"},{type:"text",name:"Descripcion",id:"description",placeholder:"La descripcion de mi primer post"},{type:"text",name:"Imagen",id:"image",placeholder:"Url de tu imagen"}],submitText:"Crear",handleSubmit:function(e){return a.apply(this,arguments)}})})},I=function(){var e,t,n=g(),a=Object(s.h)(),r=Object(c.useState)(3),l=Object(o.a)(r,2),u=l[0],d=l[1];return Object(b.jsxs)("div",{className:"vh-10 w-full bg-primary fixed bottom-0 flex justify-evenly items-center z-10",children:["admin"===(null===n||void 0===n||null===(e=n.user)||void 0===e?void 0:e.role)&&Object(b.jsxs)(i.c,{to:"/my",className:"flex flex-col items-center justify-center space-y-2 md:text-2xl lg:text-3xl ".concat(1===u&&"text-blue-800"),onClick:function(){return d(1)},children:[Object(b.jsx)(N.a,{icon:C.i}),Object(b.jsx)("span",{className:"text-xs",children:"Mis Posts"})]}),"admin"===(null===(t=n.user)||void 0===t?void 0:t.role)&&Object(b.jsxs)(i.c,{to:"/create",className:"flex flex-col items-center justify-center space-y-2 md:text-2xl lg:text-3xl ".concat(2===u&&"text-blue-800"),onClick:function(){return d(2)},children:[Object(b.jsx)(N.a,{icon:C.g}),Object(b.jsx)("span",{className:"text-xs",children:"Crear"})]}),Object(b.jsxs)(i.c,{to:"/",className:"flex flex-col items-center justify-center space-y-2 md:text-2xl lg:text-3xl ".concat(3===u&&"text-blue-800"),onClick:function(){return d(3)},children:[Object(b.jsx)(N.a,{icon:C.f}),Object(b.jsx)("span",{className:"text-xs",children:"Ver Todos"})]}),Object(b.jsxs)("button",{onClick:function(){n.signOut((function(){return a("/login")}))},className:"flex flex-col items-center justify-center space-y-2 md:text-2xl lg:text-3xl",children:[Object(b.jsx)(N.a,{icon:C.h}),Object(b.jsx)("span",{className:"text-xs",children:"Salir"})]})]})},E=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(I,{}),Object(b.jsx)("div",{className:"p-4",children:Object(b.jsx)(s.b,{})})]})},D=function(e){var t=e.children,n=g(),c=Object(s.g)();return n.user?t:Object(b.jsx)(s.a,{to:"/login",state:{from:c}})},M=function(){return Object(b.jsx)(i.b,{children:Object(b.jsx)(h,{children:Object(b.jsxs)(s.e,{children:[Object(b.jsx)(s.c,{exact:!0,path:"/login",element:Object(b.jsx)(y,{})}),Object(b.jsxs)(s.c,{element:Object(b.jsx)(E,{}),children:[Object(b.jsx)(s.c,{exact:!0,path:"/my",element:Object(b.jsx)(D,{children:Object(b.jsx)(P,{})})}),Object(b.jsx)(s.c,{exact:!0,path:"/create",element:Object(b.jsx)(D,{children:Object(b.jsx)(T,{})})}),Object(b.jsx)(s.c,{exact:!0,path:"/",element:Object(b.jsx)(D,{children:Object(b.jsx)(B,{})})})]})]})})})};r.a.render(Object(b.jsx)(i.a,{children:Object(b.jsx)(M,{})}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.0b64af7d.chunk.js.map